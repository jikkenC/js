<html>
<head>
<meta charset-"utf-8"/>

<!--キャンバス領域-->
<canvas id="pacman" width="1200" height="300">
</canvas>

	
<script type="text/javascript">

//パックマンを描画するための変数及びその座標
var cv = document.getElementById("pacman");
var ctx = cv.getContext("2d");

//パックマンスタート地点
x_zahyo = 100;
y_zahyo = 100;

//パックマンの向き
var direction;
const UP = 0;
const DOWN = 1;
const RIGHT = 2;
const LEFT = 3;

var cv2 = document.getElementById("something");
var ctx2 = cv.getContext("2d");

	function start() {
	direction = DOWN;
	//関数reDraw()を5ms間隔で呼び出す
	timerID = setInterval ('reDraw()', 5);
	//キー操作イベントの設定 addEventListener(イベント, 処理, true or false)
	//true or false: イベントの優先順位
	window.addEventListener ('keydown' , keydownfunc , false);
	}
	
	//再描画のメソッド
	function reDraw(){
		//clearRect(): 指定範囲内を透明にする
		ctx.clearRect (0 , 0 , 1200 ,300 );
		drawPacman(ctx,x_zahyo,y_zahyo);
		drawSomething(ctx2,200,200);
	}
	
	//パックマンの形状を表すメソッド
	//drawPacman(2D, 中心のx座標, 中心のy座標):
	function drawPacman(ctx,cx,cy){
		switch (direction) {
			case RIGHT:				
				//ctx.clearRect (0 , 0 , 600 ,400 ); 不必要に感じた
				ctx.strokeStyle="#FF0000";//輪郭の色
				ctx.fillStyle="#FF0000";//形状内の色
				ctx.beginPath();//現在のパスをリセット
				ctx.arc(cx,cy,50,30 * Math.PI / 180,330 * Math.PI / 180);//
				ctx.lineTo(cx,cy);
				ctx.lineTo(cx + 50 * Math.cos(30 * Math.PI/ 180),
				 		   cy + 50 * Math.sin(30 * Math.PI/ 180));
				ctx.fill();
				break;
			case LEFT:
				//ctx.clearRect (0 , 0 , 600 ,400 ); 不必要に感じた
				ctx.strokeStyle="#FF0000";
				ctx.fillStyle="#FF0000";
				ctx.beginPath();
				ctx.arc(cx,cy,50,210 * Math.PI / 180,150 * Math.PI / 180);
				ctx.lineTo(cx,cy);
				ctx.lineTo(cx + 50 * Math.cos(210 * Math.PI/ 180),
				 		   cy + 50 * Math.sin(210 * Math.PI/ 180));
				ctx.fill();
				break;
			case UP:
				//ctx.clearRect (0 , 0 , 600 ,400 ); 不必要に感じた
				ctx.strokeStyle="#FF0000";
				ctx.fillStyle="#FF0000";
				ctx.beginPath();
				ctx.arc(cx,cy,50,300 * Math.PI / 180,240 * Math.PI / 180);
				ctx.lineTo(cx,cy);
				ctx.lineTo(cx + 50 * Math.cos(300 * Math.PI/ 180),
				 		   cy + 50 * Math.sin(300 * Math.PI/ 180));
				ctx.fill();
				break;
			case DOWN:
				//ctx.clearRect (0 , 0 , 600 ,400 ); 不必要に感じた
				ctx.strokeStyle="#FF0000";
				ctx.fillStyle="#FF0000";
				ctx.beginPath();
				ctx.arc(cx,cy,50,120 * Math.PI / 180,60 * Math.PI / 180);
				ctx.lineTo(cx,cy);
				ctx.lineTo(cx + 50 * Math.cos(120 * Math.PI/ 180),
				 		   cy + 50 * Math.sin(120 * Math.PI/ 180));
				ctx.fill();
				break;
		}
		
	}
		
	//食べ物の画像なりを入れる所
	function drawSomething(ctx,cx,cy){
		ctx.fillRect(cx, cy, 20, 20);
		}
	
	function keydownfunc (event) {
	//どのキーが押されたかの情報を取得する
	var code = event.keyCode;
	//スイッチ文でケースにより処理を変える
	switch (code) {
		case 37://←キーが押された場合の番号
			direction = LEFT;
			x_zahyo -= 10;//x座標を10px減らす（左に動かす）
			break;//ここでブレークしないと下のコードが実行されてしまう
		case 39://→キーが押された場合の番号
			direction = RIGHT;
			x_zahyo += 10;//x座標を10px増やす（右に動かす）
			break;
		case 38://↑キーが押された場合の番号
			direction = UP;
			y_zahyo -= 10;//y座標を10px減らす（上に動かす）
			break;
		case 40://↓キーが押された場合の番号
			direction = DOWN;
			y_zahyo += 10;//y座標を10px増やす（下に動かす）
			break;
		}
	}
	
	//あたり判定のメソッド
	function collisionDetection(mx,my,ax,ay){
	}
	
</script>
</head>
<body onload="start()">
	
</body>
</html>
